{
  "hash": "4e80d479653f1383986a23c6b56b6b35",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A1 Fertility Dataset\"\nauthor: \"Swetha KV, Diya Bijoy, Abhinav R, Aanya Pandith\"\ndate: \"2025-09-28\"\ncategories: [Fertility]\nformat: html\n---\n# 1. Fertility Data set\n\n## Setting up R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(naniar)\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:naniar':\n\n    n_complete\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(crosstable)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'crosstable'\n\nThe following object is masked from 'package:purrr':\n\n    compact\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tinytable)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'tinytable'\n\nThe following object is masked from 'package:ggplot2':\n\n    theme_void\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: scales\n\nAttaching package: 'scales'\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n\nLoading required package: ggridges\n\nNew to ggformula?  Try the tutorials: \n\tlearnr::run_tutorial(\"introduction\", package = \"ggformula\")\n\tlearnr::run_tutorial(\"refining\", package = \"ggformula\")\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following object is masked from 'package:scales':\n\n    rescale\n\nThe following object is masked from 'package:skimr':\n\n    n_missing\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n:::\n\n\n## Read Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility <- readr::read_csv(\"Fertility.csv\") %>% \njanitor::clean_names(case=\"snake\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 254654 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (6): morekids, gender1, gender2, afam, hispanic, other\ndbl (3): rownames, age, work\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nFertility\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 254,654 × 9\n   rownames morekids gender1 gender2   age afam  hispanic other  work\n      <dbl> <chr>    <chr>   <chr>   <dbl> <chr> <chr>    <chr> <dbl>\n 1        1 no       male    female     27 no    no       no        0\n 2        2 no       female  male       30 no    no       no       30\n 3        3 no       male    female     27 no    no       no        0\n 4        4 no       male    female     35 yes   no       no        0\n 5        5 no       female  female     30 no    no       no       22\n 6        6 no       male    female     26 no    no       no       40\n 7        7 no       female  male       29 no    no       no        0\n 8        8 no       male    male       33 no    no       no       52\n 9        9 no       female  male       29 no    no       no        0\n10       10 no       male    female     27 no    no       no        0\n# ℹ 254,644 more rows\n```\n\n\n:::\n:::\n\n\n## Examine Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbase::names(Fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rownames\" \"morekids\" \"gender1\"  \"gender2\"  \"age\"      \"afam\"     \"hispanic\"\n[8] \"other\"    \"work\"    \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndplyr::glimpse(Fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 254,654\nColumns: 9\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ morekids <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ gender1  <chr> \"male\", \"female\", \"male\", \"male\", \"female\", \"male\", \"female\",…\n$ gender2  <chr> \"female\", \"male\", \"female\", \"female\", \"female\", \"female\", \"ma…\n$ age      <dbl> 27, 30, 27, 35, 30, 26, 29, 33, 29, 27, 28, 28, 35, 34, 32, 2…\n$ afam     <chr> \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", …\n$ hispanic <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ other    <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ work     <dbl> 0, 30, 0, 0, 22, 40, 0, 52, 0, 0, 0, 52, 52, 52, 8, 7, 0, 40,…\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbase::dim(Fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 254654      9\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nutils::str(Fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nspc_tbl_ [254,654 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ rownames: num [1:254654] 1 2 3 4 5 6 7 8 9 10 ...\n $ morekids: chr [1:254654] \"no\" \"no\" \"no\" \"no\" ...\n $ gender1 : chr [1:254654] \"male\" \"female\" \"male\" \"male\" ...\n $ gender2 : chr [1:254654] \"female\" \"male\" \"female\" \"female\" ...\n $ age     : num [1:254654] 27 30 27 35 30 26 29 33 29 27 ...\n $ afam    : chr [1:254654] \"no\" \"no\" \"no\" \"yes\" ...\n $ hispanic: chr [1:254654] \"no\" \"no\" \"no\" \"no\" ...\n $ other   : chr [1:254654] \"no\" \"no\" \"no\" \"no\" ...\n $ work    : num [1:254654] 0 30 0 0 22 40 0 52 0 0 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   rownames = col_double(),\n  ..   morekids = col_character(),\n  ..   gender1 = col_character(),\n  ..   gender2 = col_character(),\n  ..   age = col_double(),\n  ..   afam = col_character(),\n  ..   hispanic = col_character(),\n  ..   other = col_character(),\n  ..   work = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n\n\n:::\n:::\n\n\n## Viewing Missing Data\n\nViewing missing data was not working for the whole data set, so we used slice sample of 100000. The data set did not have any missing data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_sample <- Fertility %>% dplyr::slice_sample(n = 100000) \nvisdat::vis_dat(Fertility_sample)\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisdat::vis_miss(Fertility_sample)\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## New column for labeling ethnicity\n\nWe created a new column for ethnicity since the data set did not directly indicate whether a person was Caucasian. Based on the data dictionary, all \"no\" responses were Caucasian. To make the data easier to understand, we added a column to clearly show the ethnicity of a person.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility %>% filter(afam == \"no\", hispanic == \"no\", other == \"no\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 216,033 × 9\n   rownames morekids gender1 gender2   age afam  hispanic other  work\n      <dbl> <chr>    <chr>   <chr>   <dbl> <chr> <chr>    <chr> <dbl>\n 1        1 no       male    female     27 no    no       no        0\n 2        2 no       female  male       30 no    no       no       30\n 3        3 no       male    female     27 no    no       no        0\n 4        5 no       female  female     30 no    no       no       22\n 5        6 no       male    female     26 no    no       no       40\n 6        7 no       female  male       29 no    no       no        0\n 7        8 no       male    male       33 no    no       no       52\n 8        9 no       female  male       29 no    no       no        0\n 9       10 no       male    female     27 no    no       no        0\n10       11 yes      male    male       28 no    no       no        0\n# ℹ 216,023 more rows\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity <- Fertility %>%\n  mutate(ethnicity = case_when(\n    afam == \"yes\" & hispanic == \"no\" & other == \"no\" ~ \"AFAM\",\n    afam == \"no\" & hispanic == \"yes\" & other == \"no\" ~ \"Hispanic\",\n    afam == \"no\" & hispanic == \"no\" & other == \"yes\" ~ \"Other\",\n    afam == \"no\" & hispanic == \"no\" & other == \"no\" ~ \"Caucasian\",\n     afam == \"yes\" & hispanic == \"yes\" & other == \"no\" ~ \"AFAMHispanic\",\n     afam == \"yes\" & hispanic == \"no\" & other == \"yes\" ~ \"AFAMOther\",\n     afam == \"no\" & hispanic == \"yes\" & other == \"yes\" ~ \"HispanicOther\"\n  ))\n  \nFertility_ethnicity\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 254,654 × 10\n   rownames morekids gender1 gender2   age afam  hispanic other  work ethnicity\n      <dbl> <chr>    <chr>   <chr>   <dbl> <chr> <chr>    <chr> <dbl> <chr>    \n 1        1 no       male    female     27 no    no       no        0 Caucasian\n 2        2 no       female  male       30 no    no       no       30 Caucasian\n 3        3 no       male    female     27 no    no       no        0 Caucasian\n 4        4 no       male    female     35 yes   no       no        0 AFAM     \n 5        5 no       female  female     30 no    no       no       22 Caucasian\n 6        6 no       male    female     26 no    no       no       40 Caucasian\n 7        7 no       female  male       29 no    no       no        0 Caucasian\n 8        8 no       male    male       33 no    no       no       52 Caucasian\n 9        9 no       female  male       29 no    no       no        0 Caucasian\n10       10 no       male    female     27 no    no       no        0 Caucasian\n# ℹ 254,644 more rows\n```\n\n\n:::\n:::\n\n\n## Converting Characters to Factors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor <- Fertility_ethnicity %>%\n  mutate(across(where(is.character), as.factor)) %>% \n  relocate(where(is.factor), .after = rownames)\nglimpse(Fertility_ethnicity_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 254,654\nColumns: 10\n$ rownames  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…\n$ morekids  <fct> no, no, no, no, no, no, no, no, no, no, yes, no, no, no, no,…\n$ gender1   <fct> male, female, male, male, female, male, female, male, female…\n$ gender2   <fct> female, male, female, female, female, female, male, male, ma…\n$ afam      <fct> no, no, no, yes, no, no, no, no, no, no, no, no, no, no, no,…\n$ hispanic  <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, …\n$ other     <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, …\n$ ethnicity <fct> Caucasian, Caucasian, Caucasian, AFAM, Caucasian, Caucasian,…\n$ age       <dbl> 27, 30, 27, 35, 30, 26, 29, 33, 29, 27, 28, 28, 35, 34, 32, …\n$ work      <dbl> 0, 30, 0, 0, 22, 40, 0, 52, 0, 0, 0, 52, 52, 52, 8, 7, 0, 40…\n```\n\n\n:::\n:::\n\n\n## Summaries: Examining the Data\n\n### Counting by the gender factor variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  dplyr::count(across(.cols = c (gender1 , gender2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  gender1 gender2     n\n  <fct>   <fct>   <int>\n1 female  female  60946\n2 female  male    62724\n3 male    female  63185\n4 male    male    67799\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>% \n  group_by(morekids) %>% \n  summarise(average_age=mean(age),count=n()) %>% tt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_s6lek4e7lczfgefxfm9c(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_s6lek4e7lczfgefxfm9c\");\n          var cell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function spanCell_s6lek4e7lczfgefxfm9c(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_s6lek4e7lczfgefxfm9c\");\n        const targetCell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n        if (!targetCell) {\n          console.warn(`Cell at (${i}, ${j}) not found.`);\n        }\n\n        // Get all cells that need to be removed\n        const cellsToRemove = [];\n        for (let r = 0; r < rowspan; r++) {\n          for (let c = 0; c < colspan; c++) {\n            if (r === 0 && c === 0) continue; // Skip the target cell\n            const cell = table.querySelector(`[data-row=\"${i + r}\"][data-col=\"${j + c}\"]`);\n            if (cell) {\n              cellsToRemove.push(cell);\n            }\n          }\n        }\n\n        // Remove all cells\n        cellsToRemove.forEach(cell => cell.remove());\n\n        // Set rowspan and colspan of the target cell if it exists\n        if (targetCell) {\n          targetCell.rowSpan = rowspan;\n          targetCell.colSpan = colspan;\n        }\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 0 }, { i: '2', j: 1 }, { i: '2', j: 2 },  ], css_id: 'tinytable_css_pwrhqtq4n8wirb597ifh',}, \n          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 },  ], css_id: 'tinytable_css_tf1ka7q19jsf77aotbg3',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_s6lek4e7lczfgefxfm9c(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_pwrhqtq4n8wirb597ifh, .table th.tinytable_css_pwrhqtq4n8wirb597ifh { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_tf1ka7q19jsf77aotbg3, .table th.tinytable_css_tf1ka7q19jsf77aotbg3 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_s6lek4e7lczfgefxfm9c\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"0\">morekids</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">average_age</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">count</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"0\">no</td>\n                  <td data-row=\"1\" data-col=\"1\">30.12810</td>\n                  <td data-row=\"1\" data-col=\"2\">157742</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"0\">yes</td>\n                  <td data-row=\"2\" data-col=\"1\">30.82487</td>\n                  <td data-row=\"2\" data-col=\"2\">96912</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrosstable(morekids ~ gender2 + gender1,\n  data = Fertility_ethnicity_factor\n) %>%\n  crosstable::as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-15dd6c0a{table-layout:auto;}.cl-15b8f4e2{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-15b8f514{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-15c81620{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-15c8163e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-15c8b29c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2ba{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2c4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2ce{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2d8{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2e2{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2ec{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b2f6{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b300{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b301{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b30a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b314{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-15c8b315{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-15dd6c0a'><thead><tr style=\"overflow-wrap:break-word;\"><th  colspan=\"2\"class=\"cl-15c8b29c\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">gender1</span></p></th><th  colspan=\"2\"class=\"cl-15c8b29c\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">female</span></p></th><th  colspan=\"2\"class=\"cl-15c8b2c4\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">male</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th  colspan=\"2\"class=\"cl-15c8b2d8\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">gender2</span></p></th><th class=\"cl-15c8b2d8\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">female</span></p></th><th class=\"cl-15c8b2e2\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">male</span></p></th><th class=\"cl-15c8b2d8\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">female</span></p></th><th class=\"cl-15c8b2ec\"><p class=\"cl-15c81620\"><span class=\"cl-15b8f4e2\">male</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td  rowspan=\"2\"class=\"cl-15c8b2f6\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">morekids</span></p></td><td class=\"cl-15c8b300\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">no</span></p></td><td class=\"cl-15c8b301\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">35057 (22.22%)</span></p></td><td class=\"cl-15c8b300\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">40987 (25.98%)</span></p></td><td class=\"cl-15c8b301\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">41304 (26.18%)</span></p></td><td class=\"cl-15c8b30a\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">40394 (25.61%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-15c8b314\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">yes</span></p></td><td class=\"cl-15c8b2f6\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">25889 (26.71%)</span></p></td><td class=\"cl-15c8b314\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">21737 (22.43%)</span></p></td><td class=\"cl-15c8b2f6\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">21881 (22.58%)</span></p></td><td class=\"cl-15c8b315\"><p class=\"cl-15c8163e\"><span class=\"cl-15b8f514\">27405 (28.28%)</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrosstable(ethnicity ~ morekids,\n  data = Fertility_ethnicity_factor\n) %>%\n  crosstable::as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-165bf87c{table-layout:auto;}.cl-164865b4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-164865c8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-165176c2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-165176d6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1651c172{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1651c17c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1651c186{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1651c190{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1651c19a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-165bf87c'><thead><tr style=\"overflow-wrap:break-word;\"><th  rowspan=\"2\"class=\"cl-1651c172\"><p class=\"cl-165176c2\"><span class=\"cl-164865b4\">label</span></p></th><th  rowspan=\"2\"class=\"cl-1651c172\"><p class=\"cl-165176c2\"><span class=\"cl-164865b4\">variable</span></p></th><th  colspan=\"2\"class=\"cl-1651c17c\"><p class=\"cl-165176c2\"><span class=\"cl-164865b4\">morekids</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-1651c186\"><p class=\"cl-165176c2\"><span class=\"cl-164865b4\">no</span></p></th><th class=\"cl-1651c186\"><p class=\"cl-165176c2\"><span class=\"cl-164865b4\">yes</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td  rowspan=\"6\"class=\"cl-1651c190\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">ethnicity</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">AFAM</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">7027 (54.22%)</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">5933 (45.78%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">AFAMHispanic</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">104 (53.06%)</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">92 (46.94%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">Caucasian</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">137344 (63.58%)</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">78689 (36.42%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">Hispanic</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">5562 (50.03%)</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">5555 (49.97%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">HispanicOther</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">3522 (46.44%)</span></p></td><td class=\"cl-1651c19a\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">4062 (53.56%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1651c190\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">Other</span></p></td><td class=\"cl-1651c190\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">4183 (61.84%)</span></p></td><td class=\"cl-1651c190\"><p class=\"cl-165176d6\"><span class=\"cl-164865c8\">2581 (38.16%)</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrosstable(ethnicity ~ gender1 + gender2,\n  data = Fertility_ethnicity_factor\n) %>%\n  crosstable::as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-171c546e{table-layout:auto;}.cl-170a43fa{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-170a4418{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1711b4a0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1711b4be{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1711f910{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f924{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f925{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f92e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f938{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f942{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f94c{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f94d{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f956{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f960{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f96a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f974{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1711f97e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-171c546e'><thead><tr style=\"overflow-wrap:break-word;\"><th  colspan=\"2\"class=\"cl-1711f910\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">gender2</span></p></th><th  colspan=\"2\"class=\"cl-1711f910\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">female</span></p></th><th  colspan=\"2\"class=\"cl-1711f925\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">male</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th  colspan=\"2\"class=\"cl-1711f938\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">gender1</span></p></th><th class=\"cl-1711f938\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">female</span></p></th><th class=\"cl-1711f942\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">male</span></p></th><th class=\"cl-1711f938\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">female</span></p></th><th class=\"cl-1711f94c\"><p class=\"cl-1711b4a0\"><span class=\"cl-170a43fa\">male</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td  rowspan=\"6\"class=\"cl-1711f94d\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">ethnicity</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">AFAM</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">3141 (24.24%)</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">3267 (25.21%)</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">3223 (24.87%)</span></p></td><td class=\"cl-1711f96a\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">3329 (25.69%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">AFAMHispanic</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">47 (23.98%)</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">54 (27.55%)</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">39 (19.90%)</span></p></td><td class=\"cl-1711f96a\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">56 (28.57%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">Caucasian</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">51638 (23.90%)</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">53465 (24.75%)</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">53215 (24.63%)</span></p></td><td class=\"cl-1711f96a\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">57715 (26.72%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">Hispanic</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">2718 (24.45%)</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">2806 (25.24%)</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">2708 (24.36%)</span></p></td><td class=\"cl-1711f96a\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">2885 (25.95%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">HispanicOther</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1830 (24.13%)</span></p></td><td class=\"cl-1711f956\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1880 (24.79%)</span></p></td><td class=\"cl-1711f960\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1863 (24.56%)</span></p></td><td class=\"cl-1711f96a\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">2011 (26.52%)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-1711f974\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">Other</span></p></td><td class=\"cl-1711f94d\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1572 (23.24%)</span></p></td><td class=\"cl-1711f974\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1713 (25.33%)</span></p></td><td class=\"cl-1711f94d\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1676 (24.78%)</span></p></td><td class=\"cl-1711f97e\"><p class=\"cl-1711b4be\"><span class=\"cl-170a4418\">1803 (26.66%)</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>% \n  group_by(morekids) %>% \n  summarize(average_workhours = mean(work)) %>% tt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_as4dabrg4g0rrpxmbntc(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_as4dabrg4g0rrpxmbntc\");\n          var cell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function spanCell_as4dabrg4g0rrpxmbntc(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_as4dabrg4g0rrpxmbntc\");\n        const targetCell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n        if (!targetCell) {\n          console.warn(`Cell at (${i}, ${j}) not found.`);\n        }\n\n        // Get all cells that need to be removed\n        const cellsToRemove = [];\n        for (let r = 0; r < rowspan; r++) {\n          for (let c = 0; c < colspan; c++) {\n            if (r === 0 && c === 0) continue; // Skip the target cell\n            const cell = table.querySelector(`[data-row=\"${i + r}\"][data-col=\"${j + c}\"]`);\n            if (cell) {\n              cellsToRemove.push(cell);\n            }\n          }\n        }\n\n        // Remove all cells\n        cellsToRemove.forEach(cell => cell.remove());\n\n        // Set rowspan and colspan of the target cell if it exists\n        if (targetCell) {\n          targetCell.rowSpan = rowspan;\n          targetCell.colSpan = colspan;\n        }\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 0 }, { i: '2', j: 1 },  ], css_id: 'tinytable_css_ngdtf7j7d5ps1opy52go',}, \n          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_qg0n0itqw4j9eq7g2war',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_as4dabrg4g0rrpxmbntc(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_ngdtf7j7d5ps1opy52go, .table th.tinytable_css_ngdtf7j7d5ps1opy52go { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_qg0n0itqw4j9eq7g2war, .table th.tinytable_css_qg0n0itqw4j9eq7g2war { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_as4dabrg4g0rrpxmbntc\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"0\">morekids</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">average_workhours</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"0\">no</td>\n                  <td data-row=\"1\" data-col=\"1\">21.06843</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"0\">yes</td>\n                  <td data-row=\"2\" data-col=\"1\">15.68143</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n## Visualizing the data\n\n### 1. More Kids vs Gender Composition\n\n-   Hypothesis: Families with two daughters (female.female) could have more children.\n\n#### Dodge Bar Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  gf_bar(~interaction(gender1,gender2),\n    fill = ~morekids,\n    position = \"dodge\"\n  ) %>%\n  gf_labs(\n    title = \"Morekids vs Gender Composition\",\n    subtitle = \"How morekids is being effected based on current gender of kids\",\n    x=\"Gender of First Two Children\",\n    y=\"Count of Families\"\n  ) %>%\n  gf_refine(scale_fill_brewer(palette = \"Set1\"))\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n#### Fill Bar Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  gf_bar(~interaction(gender1,gender2),\n    fill = ~morekids,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Morekids vs Gender Composition\",\n    subtitle = \"How morekids is being effected based on current gender of kids\",\n    x=\"Gender of First Two Children\",\n    y=\"Count of yes and no\"\n  ) %>%\n  gf_refine(scale_fill_brewer(palette = \"Set1\"))\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n-   *Inferences*\n\n    -   Families with two girls are most likely to have more children.\n\n    -   Families with one boy and one girl are least likely to continue growing their family.\n\n    -   Families with two boys also show a high chance of having more kids.\n\n### 2. More kids vs Work Weeks\n\n-   Hypothesis: Women who worked less number of weeks would have more kids.\n\n#### Histogram\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_histogram(~work,\n  data = Fertility_ethnicity_factor,\n  bins = 26,                \n  fill = ~morekids,         \n  position = \"dodge\"        \n) %>%\n  gf_labs(\n    title = \"Distribution of Work Weeks by More Kids\",\n    subtitle = \"Number of Work Weeks in 1979 for Mothers with or without more kids\",\n    x = \"Work weeks in 1979\",\n    y = \"Count of yes or no\",\n  )\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n#### Line graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  count(morekids, work) %>% \n  gf_line(n ~ work, color = ~morekids, linewidth = 0.8) %>%\n  gf_labs(\n    title = \"Distribution of Work Weeks by More Kids\",\n    subtitle = \"Number of Work Weeks in 1979 for Mothers with or without more kids\",\n    x = \"Work weeks in 1979\",\n    y = \"Count of yes or no\"\n  )\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n#### Box Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>% \n  gf_boxplot(morekids ~ work, orientation = \"y\", fill=~morekids, color = \"black\") %>%\n  gf_labs(y = \"More kids\", \n          x = \"Work weeks in 1979\", \n          title = \"Distribution of Work Weeks by More Kids\",\n          subtitle = \"Number of Work Weeks in 1979 for Mothers with or without more kids\")\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n-   *Inferences*\n\n    -   Most individuals either worked a full year (52 weeks) or did not work at all (0 weeks)\n    -   *Not working* *mothers* dominates - The largest group is those who worked *0 weeks*.\n    -   *Working full year (52 weeks)* is the second largest group.\n    -   Mothers who worked between 2-50 weeks is a minority.\n    -   The difference between “more kids” and “no kids”:\n        -   People with *no kids* lean more towards full-time work.\n        -   People with *kids* lean more towards not working at all or working fewer weeks.\n\nOverall insight: The *\"no more kids\"* category *is the largest overall* especially among *non working mothers*. This shows most people in 1979 had only 2 kids.\n\n### 3. Ethnicity vs Gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  gf_bar(~ethnicity | interaction(gender1,gender2),\n    fill = ~interaction(gender1,gender2),\n    position = \"dodge\"\n  ) %>%\n  gf_labs(\n    title = \"Ethnicity vs Gender Composition\",\n    subtitle = \"How morekids is being effected based on current gender of kids\",\n    x=\"Gender of First Two Children\",\n    y=\"Count of Families\"\n  ) %>%\n  gf_refine(scale_fill_brewer(palette = \"Set2\"))\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n### 3. More kids vs Age\n\n-   Hypothesis: Older women would have more kids.\n\n#### Density Distribution Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  gf_density(~age, color = ~morekids, fill = ~morekids) %>%\n  gf_labs(\n    title = \"Distribution of Age by More Kids\",\n    subtitle = \"Ages of Mothers with or without more kids\",\n    x = \"Age of Mothers\",\n    y = \"Density\",\n    color = \"More Kids\",\n    fill = \"More Kids\"\n  )\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>% \n  gf_boxplot(morekids ~ age, orientation = \"y\", fill=~morekids, color = \"black\") %>%\n  gf_labs(y = \"Morekids\", x = \"Age of Mothers\", \n          title = \"Distribution of Age by More Kids\",\n          subtitle = \"Ages of Mothers with or without more kids\")\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n-   *Inferences*\n\n    -   The possibility of having more kids increases with age as seen as in the density distribution graph.\n\n    -   The age of people who have more kids (median 31) is only *slightly higher* than the age of people who do not have more kids (median 30)\n\n    -   The group that responded \"no\" (they do not want more kids) has a slightly wider Interquartile Range.\n\n        -   50% of mothers in the \"no\" category are *more spread out in age* from 28 to 32 years\n        -   50% of people in the \"yes\" group are *more clustered in age* from 30 to 32 years\n\n    -   Outliers: A few mothers who have more kids are *younger* than others (around age 22-23).\n\n### 1. More Kids vs Ethnicity\n\n#### Dodge Bar Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  count(ethnicity, morekids) %>%  \n  gf_col(n ~ ethnicity, fill = ~morekids, position = \"dodge\") %>%  \n  gf_labs(\n    title = \"Ethnic Group Distribution by More Kids\",\n    subtitle = \"Count of Respondents who have More Children \",\n    x = \"Ethnic Group\",\n    y = \"Number of People\",\n    fill = \"More Kids\"\n  ) %>%\n  gf_refine(scale_fill_brewer(palette = \"Set2\"))\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n#### Fill Bar Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFertility_ethnicity_factor %>%\n  count(ethnicity, morekids) %>%  \n  gf_col(n ~ ethnicity, fill = ~morekids, position = \"fill\") %>%  \n  gf_labs(\n    title = \"Ethnic Group Distribution by More Kids\",\n    subtitle = \"Count of Respondents who have More Children \",\n    x = \"Ethnic Group\",\n    y = \"Number of People\",\n    fill = \"More Kids\"\n  ) %>%\n  gf_refine(scale_fill_brewer(palette = \"Set2\"))\n```\n\n::: {.cell-output-display}\n![](Fertility_final_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n-   *Inferences*\n    -   The Caucasian group is much larger than all other ethnic groups in the survey, as seen in the first graph.\n    -   *African-Americans and Hispanics* have the highest proportion of respondents who have more kids.\n    -   The Caucasian group and the Other group have a lower proportion of having more kids.\n\n------------------------------------------------------------------------\n",
    "supporting": [
      "Fertility_final_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}